<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/5fda38894b.js" crossorigin="anonymous"></script>
    <link rel = "stylesheet" type="text/css" href="../../../../css/main.css" />
    <title>PUL GitHub Issues for 2024-01-27T22:00:04</title>
  </head>

<body>
  <div class="container-fluid">
    <a id="btt-button"></a>
    
<h1 class="bg-dark text-light">PUL GitHub Issues<br />
  <small class="text-white-70">2024-01-27</small></h1>
<nav class="navbar sticky-top navbar-dark bg-dark">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-toggler" aria-controls="navbar-toggler" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbar-toggler">
    <ul class="navbar-nav mr-auto mt-2 pt-3 mt-lg-0">
      <li class="nav-item not-mono">
        <a class="nav-link" href="../../../../index.html"><i class="fas fa-arrow-left"></i> Back to Report List Page</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#figgy">pulibrary/figgy</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#princeton_ansible">pulibrary/princeton_ansible</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#tiger-data-app">pulibrary/tiger-data-app</a>
      </li>
      </li>
    </ul>
  </div>
</nav>

    
    <section class="repo" id="figgy">
      <h2><a href="https://github.com/pulibrary/figgy">pulibrary/figgy</a> <i class="fas fa-external-link-alt fa-xs"></i></h2>
      <div class="issues">
        
      <div class="issue even" id="figgy-6189">
        <h3><a href="https://github.com/pulibrary/figgy/issues/6189">#6189</a> Build out "Collection Item And Image Count Report" to include PBCore types</h3>
        <dl>
          <dt>Creator:</dt>
          <dd>Kim Leaman</dd>
          <dt>Created:</dt>
          <dd>2024-01-26 22:01:44</dd>
          <dt>Status:</dt>
          <dd>Open
          </dd>
        </dl>
      </div>

      </div>
    </section>
    <section class="repo" id="princeton_ansible">
      <h2><a href="https://github.com/pulibrary/princeton_ansible">pulibrary/princeton_ansible</a> <i class="fas fa-external-link-alt fa-xs"></i></h2>
      <div class="issues">
        
      <div class="issue even" id="princeton_ansible-4618">
        <h3><a href="https://github.com/pulibrary/princeton_ansible/issues/4618">#4618</a> pg_stat_statements extension will not install</h3>
        <dl>
          <dt>Creator:</dt>
          <dd>Francis Kayiwa</dd>
          <dt>Created:</dt>
          <dd>2024-01-26 12:41:07</dd>
          <dt>Status:</dt>
          <dd>Open
          </dd>
          <dt>Comments:</dt>
          

          <dd class="comments">
            <dl>
              <dt>Alicia Cozine at <a href="https://github.com/pulibrary/princeton_ansible/issues/4618#issuecomment-1912818764">2024-01-26 23:19:23</a> <i class="fas fa-external-link-alt fa-xs"></i> :</dt>
              <dd class="even">
                <p>Hm. Maybe the extension is ONLY added by updating the config and we should remove that task? Let&#39;s look on Monday. </p>

              </dd>
            </dl>
          </dd>

          <dt>Events:</dt>
          <dd>
            <ul class="events">
            
  <li class="event even">
    <code>assigned</code> by Alicia Cozine at 2024-01-26 23:19:27.</li>

            </ul>
          </dd>
        </dl>
      </div>
      <div class="issue odd" id="princeton_ansible-4043">
        <h3><a href="https://github.com/pulibrary/princeton_ansible/issues/4043">#4043</a> Tower reports 404s on /websocket</h3>
        <dl>
          <dt>Creator:</dt>
          <dd>Alicia Cozine</dd>
          <dt>Created:</dt>
          <dd>2023-06-30 20:05:08</dd>
          <dt>Status:</dt>
          <dd>Open
          </dd>
          <dt>Comments:</dt>
          

          <dd class="comments">
            <dl>
              <dt>Alicia Cozine at <a href="https://github.com/pulibrary/princeton_ansible/issues/4043#issuecomment-1912420530">2024-01-26 22:37:20</a> <i class="fas fa-external-link-alt fa-xs"></i> :</dt>
              <dd class="even">
                <p>In the load balancer&#39;s Nginx access logs, I see:</p>

<pre><code>73.xxx.xxx.xxx - - [26/Jan/2024:14:36:58 +0000] &quot;GET /websocket/ HTTP/1.1&quot; 404 2502 &quot;-&quot; 128.112.IP-of-ansible-control-node:443, 404, 0.091, 0.091&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36&quot; &quot;-&quot;
</code></pre>

<p>for the IPs of both control nodes.</p>

              </dd>
              <dt>Alicia Cozine at <a href="https://github.com/pulibrary/princeton_ansible/issues/4043#issuecomment-1912800930">2024-01-26 22:55:52</a> <i class="fas fa-external-link-alt fa-xs"></i> :</dt>
              <dd class="odd">
                <p>@VickieKarasic found some resources for nginx config for websockets:</p>

<p><a href="https://www.nginx.com/blog/websocket-nginx/">https://www.nginx.com/blog/websocket-nginx/</a>
<a href="https://nginx.org/en/docs/http/websocket.html">https://nginx.org/en/docs/http/websocket.html</a></p>

              </dd>
              <dt>Alicia Cozine at <a href="https://github.com/pulibrary/princeton_ansible/issues/4043#issuecomment-1912821455">2024-01-26 23:23:50</a> <i class="fas fa-external-link-alt fa-xs"></i> :</dt>
              <dd class="even">
                <p>@sandbergja filled in a vital piece of the puzzle. These lines:
<code>
          proxy_set_header Upgrade $http_upgrade;
          proxy_set_header Connection &quot;Upgrade&quot;;
</code>
mean that the incoming request should be handled by a different protocol (not HTTP/S). Those directives should only be applied to <code>/websocket/</code> and not to any other URLs (especially not to <code>/</code>, which would alter the protocol for all incoming requests to the site). With a nested definition for <code>/websocket/</code> that applied those directives only to the one URL, live updates started working.</p>

              </dd>
            </dl>
          </dd>

          <dt>Events:</dt>
          <dd>
            <ul class="events">
            
  <li class="event even">
    <code>mentioned</code> by Vickie Karasic at 2024-01-26 22:55:52.</li>
  <li class="event odd">
    <code>subscribed</code> by Vickie Karasic at 2024-01-26 22:55:52.</li>
  <li class="event even">
    <code>mentioned</code> by Jane Sandberg at 2024-01-26 23:23:50.</li>
  <li class="event odd">
    <code>subscribed</code> by Jane Sandberg at 2024-01-26 23:23:50.</li>

            </ul>
          </dd>
        </dl>
      </div>
      <div class="issue even" id="princeton_ansible-4612">
        <h3><a href="https://github.com/pulibrary/princeton_ansible/pull/4612">#4612</a> Configure nginx to allow tower to call /websocket/</h3>
        <dl>
          <dt>Creator:</dt>
          <dd>Alicia Cozine</dd>
          <dt>Created:</dt>
          <dd>2024-01-24 22:35:54</dd>
          <dt>Status:</dt>
          <dd>Open
          (<a href="https://github.com/pulibrary/princeton_ansible/pull/4612">pull request</a>)
          </dd>
          <dt>Comments:</dt>
          

          <dd class="comments">
            <dl>
              <dt>Alicia Cozine at <a href="https://github.com/pulibrary/princeton_ansible/pull/4612#issuecomment-1912834492">2024-01-26 23:43:38</a> <i class="fas fa-external-link-alt fa-xs"></i> :</dt>
              <dd class="even">
                <p>@VickieKarasic and @sandbergja and I fixed this today - in addition to this nginx config update, we had to add a config file to Tower. The file is called <code>/etc/tower/conf.d/websocket_config.py</code> and the content is:</p>

<pre><code># support headers for real-time updates via websocket
BROADCAST_WEBSOCKET_PROTOCOL = &#39;https&#39;
BROADCAST_WEBSOCKET_PORT = 443
BROADCAST_WEBSOCKET_VERIFY_CERT = True
</code></pre>

<p>With those two changes, the WebSockets connections works and live updates come through. If you inspect the web browser, there are still some errors listed, but they don&#39;t seem to affect performance, so we are ignoring them for now. </p>

              </dd>
            </dl>
          </dd>

          <dt>Events:</dt>
          <dd>
            <ul class="events">
            
  <li class="event even">
    <code>head_ref_force_pushed</code> by Alicia Cozine at 2024-01-26 22:50:00.</li>
  <li class="event odd">
    <code>ready_for_review</code> by Alicia Cozine at 2024-01-26 22:56:47.</li>
  <li class="event even">
    <code>mentioned</code> by Jane Sandberg at 2024-01-26 23:43:39.</li>
  <li class="event odd">
    <code>subscribed</code> by Jane Sandberg at 2024-01-26 23:43:39.</li>
  <li class="event even">
    <code>mentioned</code> by Vickie Karasic at 2024-01-26 23:43:39.</li>
  <li class="event odd">
    <code>subscribed</code> by Vickie Karasic at 2024-01-26 23:43:39.</li>

            </ul>
          </dd>
        </dl>
      </div>

      </div>
    </section>
    <section class="repo" id="tiger-data-app">
      <h2><a href="https://github.com/pulibrary/tiger-data-app">pulibrary/tiger-data-app</a> <i class="fas fa-external-link-alt fa-xs"></i></h2>
      <div class="issues">
        
      <div class="issue even" id="tiger-data-app-412">
        <h3><a href="https://github.com/pulibrary/tiger-data-app/pull/412">#412</a> Aterm experimental</h3>
        <dl>
          <dt>Creator:</dt>
          <dd>Hector Correa</dd>
          <dt>Created:</dt>
          <dd>2024-01-26 22:01:33</dd>
          <dt>Status:</dt>
          <dd>Open
          (<a href="https://github.com/pulibrary/tiger-data-app/pull/412">pull request</a>)
          </dd>
        </dl>
      </div>

      </div>
    </section>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="../../../../js/report.js"></script>
  </div>
</body>

</html>
